/*
 * angular-ui-bootstrap
 * http://angular-ui.github.io/bootstrap/

 * Version: 0.14.3 - 2015-10-23
 * License: MIT
 */
angular.module("ui.bootstrap",["ui.bootstrap.tooltip","ui.bootstrap.position","ui.bootstrap.stackedMap","ui.bootstrap.typeahead"]),angular.module("ui.bootstrap.tooltip",["ui.bootstrap.position","ui.bootstrap.stackedMap"]).provider("$uibTooltip",function(){function e(e){var t=/[A-Z]/g,n="-";return e.replace(t,function(e,t){return(t?n:"")+e.toLowerCase()})}var t={placement:"top",animation:!0,popupDelay:0,popupCloseDelay:0,useContentExp:!1},n={mouseenter:"mouseleave",click:"click",focus:"blur",none:""},i={};this.options=function(e){angular.extend(i,e)},this.setTriggers=function(e){angular.extend(n,e)},this.$get=["$window","$compile","$timeout","$document","$uibPosition","$interpolate","$rootScope","$parse","$$stackedMap",function(o,a,p,r,l,s,u,c,d){var f=d.createNew();return r.on("keypress",function(e){if(27===e.which){var t=f.top();t&&(t.value.close(),f.removeTop(),t=null)}}),function(o,u,d,h){function m(e){var t=(e||h.trigger||d).split(" "),i=t.map(function(e){return n[e]||e});return{show:t,hide:i}}h=angular.extend({},t,i,h);var $=e(o),v=s.startSymbol(),g=s.endSymbol(),y="<div "+$+'-popup title="'+v+"title"+g+'" '+(h.useContentExp?'content-exp="contentExp()" ':'content="'+v+"content"+g+'" ')+'placement="'+v+"placement"+g+'" popup-class="'+v+"popupClass"+g+'" animation="animation" is-open="isOpen"origin-scope="origScope" style="visibility: hidden; display: block; top: -9999px; left: -9999px;"></div>';return{compile:function(){var e=a(y);return function(t,n,i){function a(){W.isOpen?d():s()}function s(){(!q||t.$eval(i[u+"Enable"]))&&(y(),T(),W.popupDelay?k||(k=p($,W.popupDelay,!1)):$())}function d(){v(),W.popupCloseDelay?O||(O=p(g,W.popupCloseDelay,!1)):g()}function $(){return v(),y(),W.content?(b(),void W.$evalAsync(function(){W.isOpen=!0,x(!0),L()})):angular.noop}function v(){k&&(p.cancel(k),k=null),M&&(p.cancel(M),M=null)}function g(){v(),y(),W&&W.$evalAsync(function(){W.isOpen=!1,x(!1),W.animation?U||(U=p(w,150,!1)):w()})}function y(){O&&(p.cancel(O),O=null),U&&(p.cancel(U),U=null)}function b(){P||(E=W.$new(),P=e(E,function(e){D?r.find("body").append(e):n.after(e)}),C())}function w(){I(),U=null,P&&(P.remove(),P=null),E&&(E.$destroy(),E=null)}function T(){W.title=i[u+"Title"],W.content=B?B(t):i[o],W.popupClass=i[u+"Class"],W.placement=angular.isDefined(i[u+"Placement"])?i[u+"Placement"]:h.placement;var e=parseInt(i[u+"PopupDelay"],10),n=parseInt(i[u+"PopupCloseDelay"],10);W.popupDelay=isNaN(e)?h.popupDelay:e,W.popupCloseDelay=isNaN(n)?h.popupCloseDelay:n}function x(e){N&&angular.isFunction(N.assign)&&N.assign(t,e)}function C(){V.length=0,B?(V.push(t.$watch(B,function(e){W.content=e,!e&&W.isOpen&&g()})),V.push(E.$watch(function(){H||(H=!0,E.$$postDigest(function(){H=!1,W&&W.isOpen&&L()}))}))):V.push(i.$observe(o,function(e){W.content=e,!e&&W.isOpen?g():L()})),V.push(i.$observe(u+"Title",function(e){W.title=e,W.isOpen&&L()})),V.push(i.$observe(u+"Placement",function(e){W.placement=e?e:h.placement,W.isOpen&&L()}))}function I(){V.length&&(angular.forEach(V,function(e){e()}),V.length=0)}function S(){var e=i[u+"Trigger"];R(),A=m(e),"none"!==A.show&&A.show.forEach(function(e,t){e===A.hide[t]?n[0].addEventListener(e,a):e&&(n[0].addEventListener(e,s),A.hide[t].split(" ").forEach(function(e){n[0].addEventListener(e,d)})),n.on("keypress",function(e){27===e.which&&d()})})}var P,E,U,k,O,M,D=angular.isDefined(h.appendToBody)?h.appendToBody:!1,A=m(void 0),q=angular.isDefined(i[u+"Enable"]),W=t.$new(!0),H=!1,N=angular.isDefined(i[u+"IsOpen"])?c(i[u+"IsOpen"]):!1,B=h.useContentExp?c(i[o]):!1,V=[],L=function(){P&&P.html()&&(M||(M=p(function(){P.css({top:0,left:0});var e=l.positionElements(n,P,W.placement,D);e.top+="px",e.left+="px",e.visibility="visible",P.css(e),M=null},0,!1)))};W.origScope=t,W.isOpen=!1,f.add(W,{close:g}),W.contentExp=function(){return W.content},i.$observe("disabled",function(e){e&&v(),e&&W.isOpen&&g()}),N&&t.$watch(N,function(e){W&&!e===W.isOpen&&a()});var R=function(){A.show.forEach(function(e){n.unbind(e,s)}),A.hide.forEach(function(e){e.split(" ").forEach(function(e){n[0].removeEventListener(e,d)})})};S();var F=t.$eval(i[u+"Animation"]);W.animation=angular.isDefined(F)?!!F:h.animation;var z=t.$eval(i[u+"AppendToBody"]);D=angular.isDefined(z)?z:D,D&&t.$on("$locationChangeSuccess",function(){W.isOpen&&g()}),t.$on("$destroy",function(){v(),y(),R(),w(),f.remove(W),W=null})}}}}}]}).directive("uibTooltipTemplateTransclude",["$animate","$sce","$compile","$templateRequest",function(e,t,n,i){return{link:function(o,a,p){var r,l,s,u=o.$eval(p.tooltipTemplateTranscludeScope),c=0,d=function(){l&&(l.remove(),l=null),r&&(r.$destroy(),r=null),s&&(e.leave(s).then(function(){l=null}),l=s,s=null)};o.$watch(t.parseAsResourceUrl(p.uibTooltipTemplateTransclude),function(t){var p=++c;t?(i(t,!0).then(function(i){if(p===c){var o=u.$new(),l=i,f=n(l)(o,function(t){d(),e.enter(t,a)});r=o,s=f,r.$emit("$includeContentLoaded",t)}},function(){p===c&&(d(),o.$emit("$includeContentError",t))}),o.$emit("$includeContentRequested",t)):d()}),o.$on("$destroy",d)}}}]).directive("uibTooltipClasses",function(){return{restrict:"A",link:function(e,t,n){e.placement&&t.addClass(e.placement),e.popupClass&&t.addClass(e.popupClass),e.animation()&&t.addClass(n.tooltipAnimationClass)}}}).directive("uibTooltipPopup",function(){return{replace:!0,scope:{content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html",link:function(e,t){t.addClass("tooltip")}}}).directive("uibTooltip",["$uibTooltip",function(e){return e("uibTooltip","tooltip","mouseenter")}]).directive("uibTooltipTemplatePopup",function(){return{replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},templateUrl:"template/tooltip/tooltip-template-popup.html",link:function(e,t){t.addClass("tooltip")}}}).directive("uibTooltipTemplate",["$uibTooltip",function(e){return e("uibTooltipTemplate","tooltip","mouseenter",{useContentExp:!0})}]).directive("uibTooltipHtmlPopup",function(){return{replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-popup.html",link:function(e,t){t.addClass("tooltip")}}}).directive("uibTooltipHtml",["$uibTooltip",function(e){return e("uibTooltipHtml","tooltip","mouseenter",{useContentExp:!0})}]),angular.module("ui.bootstrap.tooltip").value("$tooltipSuppressWarning",!1).provider("$tooltip",["$uibTooltipProvider",function(e){angular.extend(this,e),this.$get=["$log","$tooltipSuppressWarning","$injector",function(t,n,i){return n||t.warn("$tooltip is now deprecated. Use $uibTooltip instead."),i.invoke(e.$get)}]}]).directive("tooltipTemplateTransclude",["$animate","$sce","$compile","$templateRequest","$log","$tooltipSuppressWarning",function(e,t,n,i,o,a){return{link:function(p,r,l){a||o.warn("tooltip-template-transclude is now deprecated. Use uib-tooltip-template-transclude instead.");var s,u,c,d=p.$eval(l.tooltipTemplateTranscludeScope),f=0,h=function(){u&&(u.remove(),u=null),s&&(s.$destroy(),s=null),c&&(e.leave(c).then(function(){u=null}),u=c,c=null)};p.$watch(t.parseAsResourceUrl(l.tooltipTemplateTransclude),function(t){var o=++f;t?(i(t,!0).then(function(i){if(o===f){var a=d.$new(),p=i,l=n(p)(a,function(t){h(),e.enter(t,r)});s=a,c=l,s.$emit("$includeContentLoaded",t)}},function(){o===f&&(h(),p.$emit("$includeContentError",t))}),p.$emit("$includeContentRequested",t)):h()}),p.$on("$destroy",h)}}}]).directive("tooltipClasses",["$log","$tooltipSuppressWarning",function(e,t){return{restrict:"A",link:function(n,i,o){t||e.warn("tooltip-classes is now deprecated. Use uib-tooltip-classes instead."),n.placement&&i.addClass(n.placement),n.popupClass&&i.addClass(n.popupClass),n.animation()&&i.addClass(o.tooltipAnimationClass)}}}]).directive("tooltipPopup",["$log","$tooltipSuppressWarning",function(e,t){return{replace:!0,scope:{content:"@",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-popup.html",link:function(n,i){t||e.warn("tooltip-popup is now deprecated. Use uib-tooltip-popup instead."),i.addClass("tooltip")}}}]).directive("tooltip",["$tooltip",function(e){return e("tooltip","tooltip","mouseenter")}]).directive("tooltipTemplatePopup",["$log","$tooltipSuppressWarning",function(e,t){return{replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&",originScope:"&"},templateUrl:"template/tooltip/tooltip-template-popup.html",link:function(n,i){t||e.warn("tooltip-template-popup is now deprecated. Use uib-tooltip-template-popup instead."),i.addClass("tooltip")}}}]).directive("tooltipTemplate",["$tooltip",function(e){return e("tooltipTemplate","tooltip","mouseenter",{useContentExp:!0})}]).directive("tooltipHtmlPopup",["$log","$tooltipSuppressWarning",function(e,t){return{replace:!0,scope:{contentExp:"&",placement:"@",popupClass:"@",animation:"&",isOpen:"&"},templateUrl:"template/tooltip/tooltip-html-popup.html",link:function(n,i){t||e.warn("tooltip-html-popup is now deprecated. Use uib-tooltip-html-popup instead."),i.addClass("tooltip")}}}]).directive("tooltipHtml",["$tooltip",function(e){return e("tooltipHtml","tooltip","mouseenter",{useContentExp:!0})}]),angular.module("ui.bootstrap.position",[]).factory("$uibPosition",["$document","$window",function(e,t){function n(e,n){return e.currentStyle?e.currentStyle[n]:t.getComputedStyle?t.getComputedStyle(e)[n]:e.style[n]}function i(e){return"static"===(n(e,"position")||"static")}var o=function(t){for(var n=e[0],o=t.offsetParent||n;o&&o!==n&&i(o);)o=o.offsetParent;return o||n};return{position:function(t){var n=this.offset(t),i={top:0,left:0},a=o(t[0]);a!=e[0]&&(i=this.offset(angular.element(a)),i.top+=a.clientTop-a.scrollTop,i.left+=a.clientLeft-a.scrollLeft);var p=t[0].getBoundingClientRect();return{width:p.width||t.prop("offsetWidth"),height:p.height||t.prop("offsetHeight"),top:n.top-i.top,left:n.left-i.left}},offset:function(n){var i=n[0].getBoundingClientRect();return{width:i.width||n.prop("offsetWidth"),height:i.height||n.prop("offsetHeight"),top:i.top+(t.pageYOffset||e[0].documentElement.scrollTop),left:i.left+(t.pageXOffset||e[0].documentElement.scrollLeft)}},positionElements:function(e,t,n,i){var o,a,p,r,l=n.split("-"),s=l[0],u=l[1]||"center";o=i?this.offset(e):this.position(e),a=t.prop("offsetWidth"),p=t.prop("offsetHeight");var c={center:function(){return o.left+o.width/2-a/2},left:function(){return o.left},right:function(){return o.left+o.width}},d={center:function(){return o.top+o.height/2-p/2},top:function(){return o.top},bottom:function(){return o.top+o.height}};switch(s){case"right":r={top:d[u](),left:c[s]()};break;case"left":r={top:d[u](),left:o.left-a};break;case"bottom":r={top:d[s](),left:c[u]()};break;default:r={top:o.top-p,left:c[u]()}}return r}}}]),angular.module("ui.bootstrap.position").value("$positionSuppressWarning",!1).service("$position",["$log","$positionSuppressWarning","$uibPosition",function(e,t,n){t||e.warn("$position is now deprecated. Use $uibPosition instead."),angular.extend(this,n)}]),angular.module("ui.bootstrap.stackedMap",[]).factory("$$stackedMap",function(){return{createNew:function(){var e=[];return{add:function(t,n){e.push({key:t,value:n})},get:function(t){for(var n=0;n<e.length;n++)if(t==e[n].key)return e[n]},keys:function(){for(var t=[],n=0;n<e.length;n++)t.push(e[n].key);return t},top:function(){return e[e.length-1]},remove:function(t){for(var n=-1,i=0;i<e.length;i++)if(t==e[i].key){n=i;break}return e.splice(n,1)[0]},removeTop:function(){return e.splice(e.length-1,1)[0]},length:function(){return e.length}}}}}),angular.module("ui.bootstrap.typeahead",["ui.bootstrap.position"]).factory("uibTypeaheadParser",["$parse",function(e){var t=/^\s*([\s\S]+?)(?:\s+as\s+([\s\S]+?))?\s+for\s+(?:([\$\w][\$\w\d]*))\s+in\s+([\s\S]+?)$/;return{parse:function(n){var i=n.match(t);if(!i)throw new Error('Expected typeahead specification in form of "_modelValue_ (as _label_)? for _item_ in _collection_" but got "'+n+'".');return{itemName:i[3],source:e(i[4]),viewMapper:e(i[2]||i[1]),modelMapper:e(i[1])}}}}]).controller("UibTypeaheadController",["$scope","$element","$attrs","$compile","$parse","$q","$timeout","$document","$window","$rootScope","$uibPosition","uibTypeaheadParser",function(e,t,n,i,o,a,p,r,l,s,u,c){function d(){W.moveInProgress||(W.moveInProgress=!0,W.$digest()),z&&p.cancel(z),z=p(function(){W.matches.length&&f(),W.moveInProgress=!1},v)}function f(){W.position=E?u.offset(t):u.position(t),W.position.top+=t.prop("offsetHeight")}var h,m,$=[9,13,27,38,40],v=200,g=e.$eval(n.typeaheadMinLength);g||0===g||(g=1);var y,b,w=e.$eval(n.typeaheadWaitMs)||0,T=e.$eval(n.typeaheadEditable)!==!1,x=o(n.typeaheadLoading).assign||angular.noop,C=o(n.typeaheadOnSelect),I=angular.isDefined(n.typeaheadSelectOnBlur)?e.$eval(n.typeaheadSelectOnBlur):!1,S=o(n.typeaheadNoResults).assign||angular.noop,P=n.typeaheadInputFormatter?o(n.typeaheadInputFormatter):void 0,E=n.typeaheadAppendToBody?e.$eval(n.typeaheadAppendToBody):!1,U=n.typeaheadAppendToElementId||!1,k=e.$eval(n.typeaheadFocusFirst)!==!1,O=n.typeaheadSelectOnExact?e.$eval(n.typeaheadSelectOnExact):!1,M=o(n.ngModel),D=o(n.ngModel+"($$$p)"),A=function(t,n){return angular.isFunction(M(e))&&m&&m.$options&&m.$options.getterSetter?D(t,{$$$p:n}):M.assign(t,n)},q=c.parse(n.uibTypeahead),W=e.$new(),H=e.$on("$destroy",function(){W.$destroy()});W.$on("$destroy",H);var N="typeahead-"+W.$id+"-"+Math.floor(1e4*Math.random());t.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":N});var B=angular.element("<div uib-typeahead-popup></div>");B.attr({id:N,matches:"matches",active:"activeIdx",select:"select(activeIdx)","move-in-progress":"moveInProgress",query:"query",position:"position"}),angular.isDefined(n.typeaheadTemplateUrl)&&B.attr("template-url",n.typeaheadTemplateUrl),angular.isDefined(n.typeaheadPopupTemplateUrl)&&B.attr("popup-template-url",n.typeaheadPopupTemplateUrl);var V=function(){W.matches=[],W.activeIdx=-1,t.attr("aria-expanded",!1)},L=function(e){return N+"-option-"+e};W.$watch("activeIdx",function(e){0>e?t.removeAttr("aria-activedescendant"):t.attr("aria-activedescendant",L(e))});var R=function(e,t){return W.matches.length>t&&e?e.toUpperCase()===W.matches[t].label.toUpperCase():!1},F=function(n){var i={$viewValue:n};x(e,!0),S(e,!1),a.when(q.source(e,i)).then(function(o){var a=n===h.$viewValue;if(a&&y)if(o&&o.length>0){W.activeIdx=k?0:-1,S(e,!1),W.matches.length=0;for(var p=0;p<o.length;p++)i[q.itemName]=o[p],W.matches.push({id:L(p),label:q.viewMapper(W,i),model:o[p]});W.query=n,f(),t.attr("aria-expanded",!0),O&&1===W.matches.length&&R(n,0)&&W.select(0)}else V(),S(e,!0);a&&x(e,!1)},function(){V(),x(e,!1),S(e,!0)})};E&&(angular.element(l).bind("resize",d),r.find("body").bind("scroll",d));var z;W.moveInProgress=!1,W.query=void 0;var _,j=function(e){_=p(function(){F(e)},w)},X=function(){_&&p.cancel(_)};V(),W.select=function(i){var o,a,r={};b=!0,r[q.itemName]=a=W.matches[i].model,o=q.modelMapper(e,r),A(e,o),h.$setValidity("editable",!0),h.$setValidity("parse",!0),C(e,{$item:a,$model:o,$label:q.viewMapper(e,r)}),V(),W.$eval(n.typeaheadFocusOnSelect)!==!1&&p(function(){t[0].focus()},0,!1)},t.bind("keydown",function(e){if(0!==W.matches.length&&-1!==$.indexOf(e.which)){if(-1===W.activeIdx&&(9===e.which||13===e.which))return V(),void W.$digest();e.preventDefault(),40===e.which?(W.activeIdx=(W.activeIdx+1)%W.matches.length,W.$digest()):38===e.which?(W.activeIdx=(W.activeIdx>0?W.activeIdx:W.matches.length)-1,W.$digest()):13===e.which||9===e.which?W.$apply(function(){W.select(W.activeIdx)}):27===e.which&&(e.stopPropagation(),V(),W.$digest())}}),t.bind("blur",function(){I&&W.matches.length&&-1!==W.activeIdx&&!b&&(b=!0,W.$apply(function(){W.select(W.activeIdx)})),y=!1,b=!1});var Y=function(e){t[0]!==e.target&&3!==e.which&&0!==W.matches.length&&(V(),s.$$phase||W.$digest())};r.bind("click",Y),e.$on("$destroy",function(){r.unbind("click",Y),(E||U)&&Z.remove(),E&&(angular.element(l).unbind("resize",d),r.find("body").unbind("scroll",d)),B.remove()});var Z=i(B)(W);E?r.find("body").append(Z):U!==!1?angular.element(r[0].getElementById(U)).append(Z):t.after(Z),this.init=function(t,n){h=t,m=n,h.$parsers.unshift(function(t){return y=!0,0===g||t&&t.length>=g?w>0?(X(),j(t)):F(t):(x(e,!1),X(),V()),T?t:t?void h.$setValidity("editable",!1):(h.$setValidity("editable",!0),null)}),h.$formatters.push(function(t){var n,i,o={};return T||h.$setValidity("editable",!0),P?(o.$model=t,P(e,o)):(o[q.itemName]=t,n=q.viewMapper(e,o),o[q.itemName]=void 0,i=q.viewMapper(e,o),n!==i?n:t)})}}]).directive("uibTypeahead",function(){return{controller:"UibTypeaheadController",require:["ngModel","^?ngModelOptions","uibTypeahead"],link:function(e,t,n,i){i[2].init(i[0],i[1])}}}).directive("uibTypeaheadPopup",function(){return{scope:{matches:"=",query:"=",active:"=",position:"&",moveInProgress:"=",select:"&"},replace:!0,templateUrl:function(e,t){return t.popupTemplateUrl||"template/typeahead/typeahead-popup.html"},link:function(e,t,n){e.templateUrl=n.templateUrl,e.isOpen=function(){return e.matches.length>0},e.isActive=function(t){return e.active==t},e.selectActive=function(t){e.active=t},e.selectMatch=function(t){e.select({activeIdx:t})}}}}).directive("uibTypeaheadMatch",["$templateRequest","$compile","$parse",function(e,t,n){return{scope:{index:"=",match:"=",query:"="},link:function(i,o,a){var p=n(a.templateUrl)(i.$parent)||"template/typeahead/typeahead-match.html";e(p).then(function(e){t(e.trim())(i,function(e){o.replaceWith(e)})})}}}]).filter("uibTypeaheadHighlight",["$sce","$injector","$log",function(e,t,n){function i(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function o(e){return/<.*>/g.test(e)}var a;return a=t.has("$sanitize"),function(t,p){return!a&&o(t)&&n.warn("Unsafe use of typeahead please use ngSanitize"),t=p?(""+t).replace(new RegExp(i(p),"gi"),"<strong>$&</strong>"):t,a||(t=e.trustAsHtml(t)),t}}]),angular.module("ui.bootstrap.typeahead").value("$typeaheadSuppressWarning",!1).service("typeaheadParser",["$parse","uibTypeaheadParser","$log","$typeaheadSuppressWarning",function(e,t,n,i){return i||n.warn("typeaheadParser is now deprecated. Use uibTypeaheadParser instead."),t}]).directive("typeahead",["$compile","$parse","$q","$timeout","$document","$window","$rootScope","$uibPosition","typeaheadParser","$log","$typeaheadSuppressWarning",function(e,t,n,i,o,a,p,r,l,s,u){var c=[9,13,27,38,40],d=200;return{require:["ngModel","^?ngModelOptions"],link:function(f,h,m,$){function v(){B.moveInProgress||(B.moveInProgress=!0,B.$digest()),X&&i.cancel(X),X=i(function(){B.matches.length&&g(),B.moveInProgress=!1},d)}function g(){B.position=O?r.offset(h):r.position(h),B.position.top+=h.prop("offsetHeight")}u||s.warn("typeahead is now deprecated. Use uib-typeahead instead.");var y=$[0],b=$[1],w=f.$eval(m.typeaheadMinLength);w||0===w||(w=1);var T,x,C=f.$eval(m.typeaheadWaitMs)||0,I=f.$eval(m.typeaheadEditable)!==!1,S=t(m.typeaheadLoading).assign||angular.noop,P=t(m.typeaheadOnSelect),E=angular.isDefined(m.typeaheadSelectOnBlur)?f.$eval(m.typeaheadSelectOnBlur):!1,U=t(m.typeaheadNoResults).assign||angular.noop,k=m.typeaheadInputFormatter?t(m.typeaheadInputFormatter):void 0,O=m.typeaheadAppendToBody?f.$eval(m.typeaheadAppendToBody):!1,M=m.typeaheadAppendToElementId||!1,D=f.$eval(m.typeaheadFocusFirst)!==!1,A=m.typeaheadSelectOnExact?f.$eval(m.typeaheadSelectOnExact):!1,q=t(m.ngModel),W=t(m.ngModel+"($$$p)"),H=function(e,t){return angular.isFunction(q(f))&&b&&b.$options&&b.$options.getterSetter?W(e,{$$$p:t}):q.assign(e,t)},N=l.parse(m.typeahead),B=f.$new(),V=f.$on("$destroy",function(){B.$destroy()});B.$on("$destroy",V);var L="typeahead-"+B.$id+"-"+Math.floor(1e4*Math.random());h.attr({"aria-autocomplete":"list","aria-expanded":!1,"aria-owns":L});var R=angular.element("<div typeahead-popup></div>");R.attr({id:L,matches:"matches",active:"activeIdx",select:"select(activeIdx)","move-in-progress":"moveInProgress",query:"query",position:"position"}),angular.isDefined(m.typeaheadTemplateUrl)&&R.attr("template-url",m.typeaheadTemplateUrl),angular.isDefined(m.typeaheadPopupTemplateUrl)&&R.attr("popup-template-url",m.typeaheadPopupTemplateUrl);var F=function(){B.matches=[],B.activeIdx=-1,h.attr("aria-expanded",!1)},z=function(e){return L+"-option-"+e};B.$watch("activeIdx",function(e){0>e?h.removeAttr("aria-activedescendant"):h.attr("aria-activedescendant",z(e))});var _=function(e,t){return B.matches.length>t&&e?e.toUpperCase()===B.matches[t].label.toUpperCase():!1},j=function(e){var t={$viewValue:e};S(f,!0),U(f,!1),n.when(N.source(f,t)).then(function(n){var i=e===y.$viewValue;if(i&&T)if(n&&n.length>0){B.activeIdx=D?0:-1,U(f,!1),B.matches.length=0;for(var o=0;o<n.length;o++)t[N.itemName]=n[o],B.matches.push({id:z(o),label:N.viewMapper(B,t),model:n[o]});B.query=e,g(),h.attr("aria-expanded",!0),A&&1===B.matches.length&&_(e,0)&&B.select(0)}else F(),U(f,!0);i&&S(f,!1)},function(){F(),S(f,!1),U(f,!0)})};O&&(angular.element(a).bind("resize",v),o.find("body").bind("scroll",v));var X;B.moveInProgress=!1,F(),B.query=void 0;var Y,Z=function(e){Y=i(function(){j(e)},C)},G=function(){Y&&i.cancel(Y)};y.$parsers.unshift(function(e){return T=!0,0===w||e&&e.length>=w?C>0?(G(),Z(e)):j(e):(S(f,!1),G(),F()),I?e:e?void y.$setValidity("editable",!1):(y.$setValidity("editable",!0),null)}),y.$formatters.push(function(e){var t,n,i={};return I||y.$setValidity("editable",!0),k?(i.$model=e,k(f,i)):(i[N.itemName]=e,t=N.viewMapper(f,i),i[N.itemName]=void 0,n=N.viewMapper(f,i),t!==n?t:e)}),B.select=function(e){var t,n,o={};x=!0,o[N.itemName]=n=B.matches[e].model,t=N.modelMapper(f,o),H(f,t),y.$setValidity("editable",!0),y.$setValidity("parse",!0),P(f,{$item:n,$model:t,$label:N.viewMapper(f,o)}),F(),B.$eval(m.typeaheadFocusOnSelect)!==!1&&i(function(){h[0].focus()},0,!1)},h.bind("keydown",function(e){if(0!==B.matches.length&&-1!==c.indexOf(e.which)){if(-1===B.activeIdx&&(9===e.which||13===e.which))return F(),void B.$digest();e.preventDefault(),40===e.which?(B.activeIdx=(B.activeIdx+1)%B.matches.length,B.$digest()):38===e.which?(B.activeIdx=(B.activeIdx>0?B.activeIdx:B.matches.length)-1,B.$digest()):13===e.which||9===e.which?B.$apply(function(){B.select(B.activeIdx)}):27===e.which&&(e.stopPropagation(),F(),B.$digest())}}),h.bind("blur",function(){E&&B.matches.length&&-1!==B.activeIdx&&!x&&(x=!0,B.$apply(function(){B.select(B.activeIdx)})),T=!1,x=!1});var J=function(e){h[0]!==e.target&&3!==e.which&&0!==B.matches.length&&(F(),p.$$phase||B.$digest())};o.bind("click",J),f.$on("$destroy",function(){o.unbind("click",J),(O||M)&&K.remove(),O&&(angular.element(a).unbind("resize",v),o.find("body").unbind("scroll",v)),R.remove()});var K=e(R)(B);O?o.find("body").append(K):M!==!1?angular.element(o[0].getElementById(M)).append(K):h.after(K)}}}]).directive("typeaheadPopup",["$typeaheadSuppressWarning","$log",function(e,t){return{scope:{matches:"=",query:"=",active:"=",position:"&",moveInProgress:"=",select:"&"},replace:!0,templateUrl:function(e,t){return t.popupTemplateUrl||"template/typeahead/typeahead-popup.html"},link:function(n,i,o){e||t.warn("typeahead-popup is now deprecated. Use uib-typeahead-popup instead."),n.templateUrl=o.templateUrl,n.isOpen=function(){return n.matches.length>0},n.isActive=function(e){return n.active==e},n.selectActive=function(e){n.active=e},n.selectMatch=function(e){n.select({activeIdx:e})}}}}]).directive("typeaheadMatch",["$templateRequest","$compile","$parse","$typeaheadSuppressWarning","$log",function(e,t,n,i,o){return{restrict:"EA",scope:{index:"=",match:"=",query:"="},link:function(a,p,r){i||o.warn("typeahead-match is now deprecated. Use uib-typeahead-match instead.");var l=n(r.templateUrl)(a.$parent)||"template/typeahead/typeahead-match.html";e(l).then(function(e){t(e.trim())(a,function(e){p.replaceWith(e)})})}}}]).filter("typeaheadHighlight",["$sce","$injector","$log","$typeaheadSuppressWarning",function(e,t,n,i){function o(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")}function a(e){return/<.*>/g.test(e)}var p;return p=t.has("$sanitize"),function(t,r){return i||n.warn("typeaheadHighlight is now deprecated. Use uibTypeaheadHighlight instead."),!p&&a(t)&&n.warn("Unsafe use of typeahead please use ngSanitize"),t=r?(""+t).replace(new RegExp(o(r),"gi"),"<strong>$&</strong>"):t,p||(t=e.trustAsHtml(t)),t}}]);